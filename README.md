
# Building NEAT Bridges
>By Ryan Reedy and Chris Rosemann

## Introduction
This project attempts to generate truss bridges using genetic algorithms, implemented in Matlab. We optimize for both mass and displacement.

<img src="images/Process.PNG">
The code starts with an initial bridge consisting of two links (left). The side nodes are fixed, and a downward force is applied to the middle node. A bridge generated by the algorithm is shown before (middle) and after (right) load application, color coded with low absolute strains in blue and high absolute strains in red. Mass is calculated based on the lengths and elastic moduli of the members in the undeformed structure. Nodal displacements are computed via the direct stiffness method; only the displacement of the node(s) where load is applied is optimized.

NSGA-II code with crossover based on NEAT creates an initial population of bridges. Each iteration of the code, a bridge design will be either mutated or experience crossover. The bridges are evaluated based on the fitness function which is based on mass and deflection. The fitter bridges are chosen to continue onto the next generation. After a certain number of generations, the code stops and presents the user with the final population, a plot of the Pareto front, and a selection of the population from the Pareto front.

## Trusses Inspired by Neural Networks
There are notable similarities between artificial neural networks and mechanical structures such as trusses. Neural networks consist of neurons (nodes) connected to each other by weights (links); trusses consist of bars (links) connected at revolute joints (nodes). Given this isomorphism, can a functional truss be evolved from a minimal initial structure the same way a neural network can using an algorithm similar to NEAT?

<img src="images/Similarities.PNG">

## Key Features
- Hybrid NEAT/NSGA-II optimization algorithm
  - Multi-objective optimization for mass and displacement from NSGA-II
  - Topology crossover using innovation history from NEAT
- Genetic representation
  - Genes represent connections between nodes
  - Allows for crossover of differing topologies
- Direct stiffness solver

### NeuroEvolution of Augmenting Topologies (NEAT)
NEAT is a genetic algorithm used for evolving neural networks by [Stanley in 2002](http://nn.cs.utexas.edu/downloads/papers/stanley.ec02.pdf). In NEAT, neural networks start as minimal structures and evolve to become more complex over time. Networks with differing toplogies can be crossed over with each other because corresponding genes are tracked with a historical marker (innovation number).

### Non-dominated Sorting Genetic Algorithm II (NSGA-II)
NSGA-II is a multiobjective genetic algorithm that finds Pareto-optimal solutions, proposed by [Deb in 2002](https://www.iitk.ac.in/kangal/Deb_NSGA-II.pdf). Diversity is preserved by favoring solutions that are farther from other solutions on the Pareto front (crowding distance).

## Direct Stiffness

## Crossover

## Mutations
Each individual gene has a probability to be mutated by each type of mutation. So there is a probability that one gene will be mutated by more than one type of mutation during a cycle. There is also a probability that every gene could be mutated in a cycle or even a small possibility that no genes would be mutated.

### Six types of mutations:
- **Stiffness**
  - Changes the elastic modulus (stiffness) of a link
  - Randomly chooses from an array of set stiffness values
  - Mass is proportional to both length and stiffness

  <img src="images/Stiffness.PNG" width="269" height="168">

- **Split Link**
  - Adds a node in the center of a randomly chosen gene/link
  - This disables the old gene and creates two new genes/links

  <img src="images/Split.PNG" width="269" height="143">

- **New Node**
  - Creates a new node with two new genes/links, but does not disable the original gene/link
  - This mutation utilizes a "repulsion force" to push the new node away from the original Nodes
  - This creates helps to create a triangle structure connected to the original gene

  <img src="images/New_Node.PNG" width="257" height="145">

- **Nudge**
  - Takes a random node and moves it in a random direction
  - Can increase or decrease the mass of the bridge since it changes the size of the links
      attached to the node

  <img src="images/Nudge.PNG" width="268" height="152">

- **Toggle**
  - Disables a randomly chosen gene
  - This mutation is not used here, but is kept in the code for the future
    - Not useful to delete a link/gene in a bridge because it usually causes a collapse

  <img src="images/Toggle.PNG" width="270" height="141">

- **New Connection**
  - Adds a new link from two randomly selected nodes that were not previously connected

  <img src="images/Connection.PNG" width="266" height="153">

## Results
Initial results can be seen below with a sample of the final population. This was run with a population size of 100 and 10 generations. It took only twenty seconds to run. A large population size and a low number of generations were found to be the optimal settings for running the code. These results showed that the code was able to build realistic structures, even if it was a simple triangle. However, it can be seen that speciation is a problem, with many of the solutions being similar to one another.

<img src="images/Initial_Results.png" width="386" height="385">

After more work on the code, final results can be viewed below

## Conclusions
